package com.demo.common.model;

import java.util.Date;

import com.alibaba.fastjson.JSONObject;
import com.demo.common.model.base.BaseT1doLog;
import com.demo.util.StrUtil;
import com.jfinal.plugin.activerecord.Db;

/**
 * Generated by JFinal.
 */
@SuppressWarnings("serial")
public class T1doLog extends BaseT1doLog<T1doLog> {
	public static final T1doLog dao = new T1doLog().dao();
	
	/*
	 2018年8月14日上午11:05:29 方升群 // 查询该人是否查看过 true没有看过，false看过
	*/
	public static boolean getisLook(String showid,String loginName) {
		return T1doLog.dao.findFirst("select * from t_1do_log where SHOW_ID=? and O_USER =? and log_type=2",showid,loginName)==null?true:false;
		
	}
	/*
	 2018年8月31日上午11:16:12 方升群
	*/
	public static boolean saveLog(String SHOW_ID,String O_USER,String O_USER_NAME,String log,int log_type,String content) {
		if(StrUtil.isNotEmpty(content)){
			return new T1doLog().setShowId(SHOW_ID).setOpTime(new Date()).setOUser(O_USER).setOUserName(O_USER_NAME).setLog(log).setContent(content).setLogType(log_type).save();
        }
		return new T1doLog().setShowId(SHOW_ID).setOpTime(new Date()).setOUser(O_USER).setOUserName(O_USER_NAME).setLog(log).setLogType(log_type).save();

	}
	/*
	 2018年8月31日上午11:16:12 方升群
	 */
	public static boolean saveLog1(String SHOW_ID,String O_USER,String O_USER_NAME,String log,int log_type,String content,int oprator) {
		
	   return new T1doLog().setShowId(SHOW_ID).setOpTime(new Date()).setOUser(O_USER).setOUserName(O_USER_NAME).setLog(log).setContent(content).setLogType(log_type).setOprator(""+oprator).save();
	
		
	}
	public static void saveLog(JSONObject user,Long item_id,String showId) {
		 new T1doLog().setShowId(showId).setOUser(user.getString("loginName")).setOUserName(user.getString("username"))
    	 .setOpTime(new Date()).setLog(user.getString("username")+"修改所属项目").setLogType(18).setContent(item_id+"").save();
	}
	//设置日志数据过期
	public static void updateIsoverdue(String SHOW_ID) {
		Db.update("update t_1do_log set isoverdue=2 where SHOW_ID=?",SHOW_ID);
	}
	
}
